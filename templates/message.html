{% extends "base.html" %}

{% block title %}{{ post.metadata.title }}{% endblock %}

{% block content %}
    <p><a href="../index.html">&larr; Kembali ke Daftar Pesan</a></p>
    <article class="message">
        <h2>{{ post.metadata.title }}</h2>
        {% if post.metadata.og_image %}
        <img src="{{ '../' * depth }}{{ post.metadata.og_image }}" alt="{{ post.metadata.title }}" class="og-image">
        {% endif %}
        <div class="metadata">
            <span>Date: {{ post.date }}</span>
            {% if post.metadata.tags %}
                <span class="tags">
                    Tags:
                    {% for tag in post.metadata.tags %}
                        <a href="../tags/{{ tag }}.html">{{ tag }}</a>{% if not loop.last %}, {% endif %}
                    {% endfor %}
                </span>
            {% endif %}
        </div>
        <div class="content content-wrapper">
            {{ post.html | safe }}
        </div>
        {% if post.caption %}
        <div class="caption">
            <hr>
            <h4>Syarah:</h4>
            {{ post.caption | safe }}
        </div>
        {% endif %}
    </article>

    <button id="shareButton">Bagikan</button>

    <script>
        const shareButton = document.getElementById('shareButton');
        if (navigator.share) {
            shareButton.addEventListener('click', async () => {
                try {
                    await navigator.share({
                        title: '{{ post.metadata.title }}',
                        text: '{{ post.og_image_text }}',
                        url: window.location.href
                    });
                    console.log('Content shared successfully');
                } catch (error) {
                    console.error('Error sharing:', error);
                }
            });
        } else {
            shareButton.style.display = 'none'; // Hide button if Web Share API is not supported
            console.log('Web Share API not supported in this browser.');
        }
    </script>
{% endblock %}
